<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Admin Dashboard — GreenStay</title>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: 'Prompt', sans-serif
    }
  </style>
</head>

<body class="bg-gray-50 min-h-screen flex flex-col">
  <header class="bg-white border-b p-4 flex items-center justify-between sticky top-0 z-40">
    <div class="flex items-center gap-3">
      <button id="mobileMenuBtn" class="md:hidden p-2 -ml-2 text-gray-600 hover:bg-gray-100 rounded focus:outline-none">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
      <div class="font-semibold text-lg">บ้านกฤติญา</div>
    </div>
    <div class="flex items-center gap-4">
      <div class="text-sm hidden sm:block">Admin</div>
      <a href="/" class="text-sm text-green-700 font-medium">ออกจากระบบ</a>
    </div>
  </header>

  <!-- Mobile Sidebar Overlay -->
  <div id="mobileSidebar"
    class="fixed inset-0 bg-black/50 z-50 hidden md:hidden transition-opacity duration-300 opacity-0">
    <aside id="mobileSidebarPanel"
      class="w-64 bg-white h-full shadow-xl flex flex-col transform -translate-x-full transition-transform duration-300 ease-in-out">
      <div class="p-4 border-b flex justify-between items-center">
        <div class="font-semibold text-lg">เมนู</div>
        <button id="closeMobileMenuBtn" class="p-2 -mr-2 text-gray-600 hover:bg-gray-100 rounded focus:outline-none">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>
      <nav class="p-4 space-y-2 overflow-y-auto flex-1">
        <button data-page="dashboard" class="w-full text-left px-3 py-2 rounded page-btn bg-green-50">แดชบอร์ด</button>
        <button data-page="rooms" class="w-full text-left px-3 py-2 rounded page-btn">ห้องพัก</button>
        <button data-page="requests" class="w-full text-left px-3 py-2 rounded page-btn">คำขอการจอง</button>
        <button data-page="bills" class="w-full text-left px-3 py-2 rounded page-btn">บิล</button>
        <button data-page="payments" class="w-full text-left px-3 py-2 rounded page-btn">ชำระเงิน</button>
        <button data-page="users" class="w-full text-left px-3 py-2 rounded page-btn">ผู้ใช้</button>
        <button data-page="contracts" class="w-full text-left px-3 py-2 rounded page-btn">สัญญา</button>
      </nav>
    </aside>
  </div>

  <div class="flex-1 flex overflow-hidden">
    <aside class="w-64 bg-white border-r hidden md:block">
      <nav class="p-4 space-y-2">
        <button data-page="dashboard" class="w-full text-left px-3 py-2 rounded page-btn bg-green-50">แดชบอร์ด</button>
        <button data-page="rooms" class="w-full text-left px-3 py-2 rounded page-btn">ห้องพัก</button>
        <button data-page="requests" class="w-full text-left px-3 py-2 rounded page-btn">คำขอการจอง</button>
        <button data-page="bills" class="w-full text-left px-3 py-2 rounded page-btn">บิล</button>
        <button data-page="payments" class="w-full text-left px-3 py-2 rounded page-btn">ชำระเงิน</button>
        <button data-page="users" class="w-full text-left px-3 py-2 rounded page-btn">ผู้ใช้</button>
        <button data-page="contracts" class="w-full text-left px-3 py-2 rounded page-btn">สัญญา</button>
      </nav>
    </aside>

    <main class="flex-1 overflow-auto p-6">
      <div id="dashboard" class="page-view">
        <h2 class="text-2xl font-semibold mb-4">ภาพรวมแดชบอร์ด</h2>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
          <div class="bg-white p-4 rounded shadow">
            <div class="text-sm text-gray-500">ห้องพักทั้งหมด</div>
            <div id="totalRooms" class="text-2xl font-bold">--</div>
          </div>
          <div class="bg-white p-4 rounded shadow">
            <div class="text-sm text-gray-500">ห้องว่าง</div>
            <div id="availableRooms" class="text-2xl font-bold">--</div>
          </div>
          <div class="bg-white p-4 rounded shadow">
            <div class="text-sm text-gray-500">ห้องเต็ม</div>
            <div id="occupiedRooms" class="text-2xl font-bold">--</div>
          </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
          <!-- Room Status Chart -->
          <div class="bg-white rounded-xl p-6 shadow-sm">
            <h3 class="mb-4">แผนภูมิสถานะห้องพัก</h3>
            <div style="height:300px;">
              <canvas id="roomChart" style="width:100%;height:100%;"></canvas>
            </div>
          </div>

          <!-- Recent Booking Requests -->
          <div class="bg-white rounded-xl p-6 shadow-sm">
            <h3 class="mb-4">คำขอการจองล่าสุด</h3>
            <div id="recentRequests" class="space-y-2"></div>
          </div>
        </div>
      </div>

      <div id="rooms" class="page-view hidden">
        <h2 class="text-2xl font-semibold mb-4">จัดการห้องพัก</h2>
        <div class="bg-white rounded shadow overflow-auto">
          <table class="min-w-full text-left">
            <thead class="bg-gray-100">
              <tr>
                <th class="px-4 py-2">ห้อง</th>
                <th class="px-4 py-2">สถานะ</th>
                <th class="px-4 py-2">ราคา / เดือน</th>
                <th class="px-4 py-2">จัดการ</th>
              </tr>
            </thead>
            <tbody id="roomsTable"></tbody>
          </table>
        </div>
      </div>

      <div id="requests" class="page-view hidden">
        <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 gap-4">
          <h2 class="text-2xl font-semibold">คำขอการจอง</h2>
          <div class="flex items-center gap-2">
            <label class="text-sm font-medium text-gray-700">เดือน/ปี:</label>
            <input type="month" id="filterRequests"
              class="border rounded p-2 focus:outline-none focus:ring-2 focus:ring-green-500 text-sm" />
          </div>
        </div>
        <div id="requestsList" class="space-y-3"></div>
      </div>

      <div id="bills" class="page-view hidden">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-2xl font-semibold">บิล</h2>
          <button id="showAddBillModal"
            class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 text-sm font-medium">เพิ่มบิล</button>
        </div>
        <div id="billsList" class="space-y-3"></div>
      </div>

      <div id="payments" class="page-view hidden">
        <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 gap-4">
          <h2 class="text-2xl font-semibold">ประวัติการชำระเงิน</h2>
          <div class="flex items-center gap-2">
            <label class="text-sm font-medium text-gray-700">เดือน/ปี:</label>
            <input type="month" id="filterPayments"
              class="border rounded p-2 focus:outline-none focus:ring-2 focus:ring-green-500 text-sm" />
          </div>
        </div>
        <div id="paymentsList" class="space-y-3"></div>
      </div>

      <div id="users" class="page-view hidden">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-2xl font-semibold">ผู้ใช้งาน</h2>
          <button id="showAddUserModal"
            class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 text-sm font-medium">เพิ่มผู้ใช้</button>
        </div>
        <div id="usersList" class="space-y-3"></div>
      </div>

      <div id="contracts" class="page-view hidden">
        <div class="flex flex-col sm:flex-row sm:justify-between sm:items-center mb-4 gap-4">
          <h2 class="text-2xl font-semibold">สัญญาเช่า</h2>
          <div class="flex flex-wrap items-center gap-2">
            <label class="text-sm font-medium text-gray-700">เดือน/ปี:</label>
            <input type="month" id="filterContracts"
              class="border rounded p-2 focus:outline-none focus:ring-2 focus:ring-green-500 text-sm" />
            <button id="showAddContractModal"
              class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 text-sm font-medium">เพิ่มสัญญา</button>
          </div>
        </div>
        <div id="contractsList" class="space-y-3"></div>
      </div>
    </main>
  </div>

  <!-- Slip modal -->
  <div id="slipModal" class="hidden fixed inset-0 bg-black/50 z-50 items-center justify-center">
    <div class="bg-white p-4 rounded shadow max-w-2xl w-full mx-4">
      <div class="flex justify-end">
        <button id="closeSlip" class="px-3 py-1 text-sm text-gray-600 hover:text-gray-900">ปิด</button>
      </div>
      <div class="mt-2">
        <img id="slipImg" src="" alt="Slip" class="w-full h-auto rounded" />
      </div>
    </div>
  </div>

  <!-- User Form Modal -->
  <div id="userModal" class="hidden fixed inset-0 bg-black/50 z-50 items-center justify-center">
    <div class="bg-white p-6 rounded-xl shadow-lg max-w-sm w-full mx-4">
      <h3 id="userModalTitle" class="text-xl font-bold mb-4">เพิ่มผู้ใช้งาน</h3>
      <form id="userForm" class="space-y-4">
        <div>
          <label class="block text-sm font-medium mb-1">ชื่อผู้ใช้</label>
          <input type="text" id="userUsername" required
            class="w-full border rounded p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">รหัสผ่าน</label>
          <input type="text" id="userPassword" required
            class="w-full border rounded p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">ห้อง</label>
          <select id="userRoom" required
            class="w-full border rounded p-2 bg-gray-50 focus:outline-none focus:ring-2 focus:ring-green-500">
            <!-- options will be injected -->
          </select>
        </div>
        <div class="flex justify-end gap-2 mt-6">
          <button type="button" id="cancelUserBtn"
            class="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded font-medium transition-colors">ยกเลิก</button>
          <button type="submit"
            class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 font-medium transition-colors border border-transparent">เพิ่ม</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Contract Form Modal -->
  <div id="contractModal" class="hidden fixed inset-0 bg-black/50 z-50 items-center justify-center">
    <div class="bg-white p-6 rounded-xl shadow-lg max-w-sm w-full mx-4">
      <h3 id="contractModalTitle" class="text-xl font-bold mb-4">เพิ่มสัญญาเช่าใหม่</h3>
      <form id="contractForm" class="space-y-4">
        <div>
          <label class="block text-sm font-medium mb-1">ห้อง</label>
          <select id="contractRoom" required
            class="w-full border rounded p-2 bg-gray-50 focus:outline-none focus:ring-2 focus:ring-green-500">
            <!-- options will be injected -->
          </select>
        </div>
        <div>
          <label class="block text-sm font-medium mb-1">อัปโหลดไฟล์ (จำลอง)</label>
          <input type="file" id="contractFile" required
            class="w-full border rounded p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
        </div>
        <div class="flex justify-end gap-2 mt-6">
          <button type="button" id="cancelContractBtn"
            class="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded font-medium transition-colors">ยกเลิก</button>
          <button type="submit"
            class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 font-medium transition-colors border border-transparent">บันทึก</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Bill Form Modal -->
  <div id="billModal" class="hidden fixed inset-0 bg-black/50 z-50 items-center justify-center">
    <div class="bg-white p-6 rounded-xl shadow-lg max-w-md w-full mx-4 max-h-screen overflow-y-auto">
      <h3 id="billModalTitle" class="text-xl font-bold mb-4">เพิ่มบิลใหม่</h3>
      <form id="billForm" class="space-y-4">
        <input type="hidden" id="billId" />
        <div>
          <label class="block text-sm font-medium mb-1">ห้อง</label>
          <select id="billRoom" required
            class="w-full border rounded p-2 bg-gray-50 focus:outline-none focus:ring-2 focus:ring-green-500">
            <!-- options will be injected -->
          </select>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium mb-1">เดือน</label>
            <select id="billMonth"
              class="w-full border rounded p-2 bg-gray-50 focus:outline-none focus:ring-2 focus:ring-green-500">
              <option value="มกราคม">มกราคม</option>
              <option value="กุมภาพันธ์">กุมภาพันธ์</option>
              <option value="มีนาคม">มีนาคม</option>
              <option value="เมษายน">เมษายน</option>
              <option value="พฤษภาคม">พฤษภาคม</option>
              <option value="มิถุนายน">มิถุนายน</option>
              <option value="กรกฎาคม">กรกฎาคม</option>
              <option value="สิงหาคม">สิงหาคม</option>
              <option value="กันยายน">กันยายน</option>
              <option value="ตุลาคม">ตุลาคม</option>
              <option value="พฤศจิกายน">พฤศจิกายน</option>
              <option value="ธันวาคม">ธันวาคม</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium mb-1">ปี</label>
            <input type="number" id="billYear" required
              class="w-full border rounded p-2 bg-gray-50 focus:outline-none focus:ring-2 focus:ring-green-500"
              value="2026" />
          </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium mb-1">มิเตอร์น้ำที่แล้ว</label>
            <input type="number" id="prevWater" required class="w-full border rounded p-2 bg-gray-100 text-gray-500"
              readonly />
          </div>
          <div>
            <label class="block text-sm font-medium mb-1">มิเตอร์น้ำเดือนนี้</label>
            <input type="number" id="currWater" required
              class="w-full border rounded p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>
        </div>
        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium mb-1">มิเตอร์ไฟที่แล้ว</label>
            <input type="number" id="prevElec" required class="w-full border rounded p-2 bg-gray-100 text-gray-500"
              readonly />
          </div>
          <div>
            <label class="block text-sm font-medium mb-1">มิเตอร์ไฟเดือนนี้</label>
            <input type="number" id="currElec" required
              class="w-full border rounded p-2 focus:outline-none focus:ring-2 focus:ring-green-500" />
          </div>
        </div>

        <div class="bg-green-50 p-4 rounded-lg text-sm space-y-2 mt-4 text-green-900">
          <div class="flex justify-between">
            <span>ค่าห้องพัก:</span>
            <span id="calcRoomPrice" class="font-medium">฿0</span>
          </div>
          <div class="flex justify-between">
            <span>ค่าน้ำ (ยูนิตละ 25฿):</span>
            <span id="calcWaterCost" class="font-medium">฿0</span>
          </div>
          <div class="flex justify-between">
            <span>ค่าไฟ (หน่วยละ 7฿):</span>
            <span id="calcElecCost" class="font-medium">฿0</span>
          </div>
          <hr class="border-green-200" />
          <div class="flex justify-between font-bold text-lg text-green-700">
            <span>รวมทั้งหมด:</span>
            <span id="calcTotalCost">฿0</span>
          </div>
        </div>

        <div class="flex justify-end gap-2 mt-6">
          <button type="button" id="cancelBillBtn"
            class="px-4 py-2 text-gray-600 hover:bg-gray-100 rounded font-medium transition-colors">ยกเลิก</button>
          <button type="submit" id="saveBillBtn"
            class="px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 font-medium transition-colors border border-transparent">สร้าง</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Bill Details Modal -->
  <div id="billDetailsModal" class="hidden fixed inset-0 bg-black/50 z-50 items-center justify-center">
    <div class="bg-white p-6 rounded-xl shadow-lg max-w-sm w-full mx-4">
      <h3 class="text-xl font-bold mb-4">รายละเอียดบิล</h3>
      <div id="billDetailsContent" class="space-y-3 text-sm text-gray-700">
        <!-- Rendered by JS -->
      </div>
      <div class="flex justify-end mt-6">
        <button type="button" id="closeBillDetailsBtn"
          class="px-4 py-2 bg-gray-100 text-gray-800 rounded-lg hover:bg-gray-200 font-medium transition-colors">ปิด</button>
      </div>
    </div>
  </div>

  <script src="js/admin-dashboard.js"></script>
</body>

</html>